!function(){if(!window._bcCsrfProtectionPatched){window._bcCsrfProtectionPatched=!0;var e=Object.getPrototypeOf(new window.XMLHttpRequest),t=e.open,n=e.send,i=e.setRequestHeader;if(e.open=function(){const e=d(arguments[1]);return this._isLocalRequest=o(e),this._isAssetRequest=u(arguments[0],e),t.apply(this,arguments)},e.send=function(){if(this._isLocalRequest&&!this._isAssetRequest){var e=a(),t=a("SF-CSRF-TOKEN");e&&!this._hasCsrfToken&&this.setRequestHeader("X-XSRF-TOKEN",e),t&&!this._hasSfCsrfToken&&this.setRequestHeader("X-SF-CSRF-TOKEN",t)}return n.apply(this,arguments)},e.setRequestHeader=function(){return"X-XSRF-TOKEN"===arguments[0]&&arguments[1]&&(this._hasCsrfToken=!0),"X-SF-CSRF-TOKEN"===arguments[0]&&arguments[1]&&(this._hasSfCsrfToken=!0),i.apply(this,arguments)},window.$&&window.$.fn&&window.$.fn.jquery?$(document).submit(c):document.addEventListener("submit",c),window.fetch){var r=window.fetch;window.fetch=function(e,t){if(window.Request){var n=new Request(e,t);return o(n.url)&&!u(n.method,n.url)&&h(n),r(n)}var i=d(e),s=t||{};return o(i)&&!u(s.method,i)&&h(s),r(i,s)}}var s=[new RegExp("^"+window.location.origin+"/wishlist.php"),new RegExp("^/?wishlist.php")]}function a(e="XSRF-TOKEN"){for(var t=document.cookie.split("; "),n=0;n<t.length;n++){var i=t[n].split("="),r=i[0],s=i[1];if(e===r)return s}return""}function o(e){return!!e.match(new RegExp("^(https?:)?//"+window.location.hostname))||!e.match(new RegExp("^(https?:)?//"))}function u(e,t){return(!e||"GET"===e.toUpperCase())&&/\.(png|gif|jpe?g|css|js|json|svg|html?)$/.test(t.split("?")[0])}function h(e){e.headers=e.headers||{};var t=a(),n=a("SF-CSRF-TOKEN");e.headers.append?(t&&(e.headers.delete("X-XSRF-TOKEN"),e.headers.append("X-XSRF-TOKEN",t)),n&&(e.headers.delete("X-SF-CSRF-TOKEN"),e.headers.append("X-SF-CSRF-TOKEN",n))):(t&&(e.headers["X-XSRF-TOKEN"]=t),n&&(e.headers["X-SF-CSRF-TOKEN"]=n))}function d(e){return e instanceof window.URL?e.href:e}function c(e){var t=e.target.getAttribute("action");null!=t&&function(e,t){for(var n=0;n<t.length;n++)if(e&&e.match(t[n]))return!0;return!1}(t,s)&&(e.target.method="POST");var n=e.target.querySelector('input[name="authenticity_token"]'),i=e.target.querySelector('input[name="sf_authenticity_token"]');if(!(n&&i||"post"!==e.target.method.toLowerCase())){if(null==n){var r=document.createElement("input");r.setAttribute("type","hidden"),r.setAttribute("name","authenticity_token"),r.setAttribute("value",a()),e.target.appendChild(r)}if(null==i){var o=document.createElement("input");o.setAttribute("type","hidden"),o.setAttribute("name","sf_authenticity_token"),o.setAttribute("value",a("SF-CSRF-TOKEN")),e.target.appendChild(o)}}}}();
//# sourceMappingURL=csrf-protection-header-5eeddd5de78d98d146ef4fd71b2aedce4161903e.js.map
